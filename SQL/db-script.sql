CREATE DATABASE IF NOT EXISTS frankenstore;
USE frankenstore;

-- CUSTOMERS are the customers of the webshop

CREATE TABLE CUSTOMERS(
	CUSTOMER_ID INT NOT NULL AUTO_INCREMENT, 
	NAME VARCHAR(50),
	PRIMARY KEY(CUSTOMER_ID)
);

-- ORDERS are all the orders from customers
-- One customer may have many orders, but one order
-- only belongs to onecustomer.

CREATE TABLE ORDERS(
	ORDER_ID INT  NOT NULL AUTO_INCREMENT, 
	CUSTOMER INT, 
	PRIMARY KEY(ORDER_ID)
);



CREATE TABLE PRODUCTS(
	PRODUCT_ID INT NOT NULL AUTO_INCREMENT,
	NAME VARCHAR(50),
	PRIMARY KEY(PRODUCT_ID)
);

-- PRODUCTS_IN_ORDER exists because of the M:N relation between ORDERS and PRODUCTS

CREATE TABLE PRODUCTS_IN_ORDER(
	PRODUCT_ID INT NOT NULL,
	ORDER_ID INT NOT NULL,
	QUANTITY INT,
	CONSTRAINT pk_PRODUCTS_IN_ORDER PRIMARY KEY(PRODUCT_ID, ORDER_ID)
);

CREATE TABLE COMPONENTS(
	COMPONENT_ID INT NOT NULL AUTO_INCREMENT,
	NAME VARCHAR(50),
	QUANTITY INT,
	PRIMARY KEY(COMPONENT_ID)
);

-- COMPONENTS_IN_PRODUCT exists because of the M:N relation between PRODUCTS and COMPONENTS

CREATE TABLE COMPONENTS_IN_PRODUCT(
	COMPONENT_ID INT NOT NULL,
	PRODUCT_ID INT NOT NULL,
	CONSTRAINT pk_COMPONENTS_IN_PRODUCT PRIMARY KEY(COMPONENT_ID,PRODUCT_ID)
);


-- Some customers. The CUSTOMER_ID will be generated by the sequence

INSERT INTO CUSTOMERS(NAME) VALUES('Kalle Anka');
INSERT INTO CUSTOMERS(NAME) VALUES('Musse Pigg');
INSERT INTO CUSTOMERS(NAME) VALUES('Dr. Frankenstein');
INSERT INTO CUSTOMERS(NAME) VALUES('Batman');

INSERT INTO PRODUCTS(NAME) VALUES('Frankenhuman');
INSERT INTO PRODUCTS(NAME) VALUES('Frankenhorse');
INSERT INTO PRODUCTS(NAME) VALUES('Frankendragon');
INSERT INTO PRODUCTS(NAME) VALUES('Frankenshark');

INSERT INTO COMPONENTS(NAME) VALUES('Human Arm');
INSERT INTO COMPONENTS(NAME) VALUES('Human Leg');
INSERT INTO COMPONENTS(NAME) VALUES('Human Head');
INSERT INTO COMPONENTS(NAME) VALUES('Human Hand');
INSERT INTO COMPONENTS(NAME) VALUES('Human Foot');
INSERT INTO COMPONENTS(NAME) VALUES('Human Torso');
INSERT INTO COMPONENTS(NAME) VALUES('Horse Leg');
INSERT INTO COMPONENTS(NAME) VALUES('Horse Head');
INSERT INTO COMPONENTS(NAME) VALUES('Horse Body');
INSERT INTO COMPONENTS(NAME) VALUES('Dragon Head');
INSERT INTO COMPONENTS(NAME) VALUES('Dragon Claw');
INSERT INTO COMPONENTS(NAME) VALUES('Dragon Leg');
INSERT INTO COMPONENTS(NAME) VALUES('Dragon Tail');
INSERT INTO COMPONENTS(NAME) VALUES('Dragon Fangs');
INSERT INTO COMPONENTS(NAME) VALUES('Dragon Wing');
INSERT INTO COMPONENTS(NAME) VALUES('Dragon Body');
INSERT INTO COMPONENTS(NAME) VALUES('Shark Fin');
INSERT INTO COMPONENTS(NAME) VALUES('Shark Jaws');
INSERT INTO COMPONENTS(NAME) VALUES('Shark Body');



-- CONSTRAINTS
ALTER TABLE ORDERS
ADD CONSTRAINT fk_CUSTOMER
FOREIGN KEY (CUSTOMER)
REFERENCES CUSTOMERS(CUSTOMER_ID);

ALTER TABLE PRODUCTS_IN_ORDER
ADD CONSTRAINT fk_PRODUCT_ID
FOREIGN KEY (PRODUCT_ID)
REFERENCES PRODUCTS(PRODUCT_ID);

ALTER TABLE PRODUCTS_IN_ORDER
ADD CONSTRAINT fk_ORDER_ID
FOREIGN KEY (ORDER_ID)
REFERENCES ORDERS(ORDER_ID);

ALTER TABLE COMPONENTS_IN_PRODUCT
ADD CONSTRAINT fk_COMPONENT_ID
FOREIGN KEY (COMPONENT_ID)
REFERENCES COMPONENTS(COMPONENT_ID);

ALTER TABLE COMPONENTS_IN_PRODUCT
ADD CONSTRAINT fk_PRODCUT_ID
FOREIGN KEY (PRODUCT_ID)
REFERENCES PRODUCTS(PRODUCT_ID);
